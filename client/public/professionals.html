<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Profissionais - Cl√≠nica Equidade</title>
  <style>
    :root {
      --primary: #4b6cb7;
      --primary-dark: #3a5a9c;
      --secondary: #182848;
      --text-main: #333;
      --text-light: #666;
      --bg-light: #f5f7fa;
      --bg-white: #ffffff;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --border: #e5e7eb;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: var(--bg-light);
      color: var(--text-main);
      line-height: 1.5;
    }
    
    .layout {
      display: flex;
      min-height: 100vh;
    }
    
    /* Sidebar */
    .sidebar {
      width: 260px;
      background-color: var(--secondary);
      color: white;
      padding: 20px 0;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 10;
    }
    
    .logo {
      padding: 0 20px 20px;
      font-size: 24px;
      font-weight: 600;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 20px;
    }
    
    .nav-list {
      list-style: none;
    }
    
    .nav-item {
      margin-bottom: 5px;
    }
    
    .nav-link {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: rgba(255, 255, 255, 0.7);
      text-decoration: none;
      transition: all 0.2s;
    }
    
    .nav-link:hover, .nav-link.active {
      background-color: rgba(255, 255, 255, 0.1);
      color: white;
    }
    
    .nav-icon {
      margin-right: 10px;
      width: 20px;
      text-align: center;
    }
    
    /* Main content */
    .main-content {
      flex: 1;
      margin-left: 260px;
      padding: 20px;
    }
    
    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      background-color: var(--bg-white);
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .page-title {
      font-size: 24px;
      font-weight: 600;
    }
    
    .user-menu {
      display: flex;
      align-items: center;
    }
    
    .user-info {
      margin-right: 15px;
      text-align: right;
    }
    
    .user-name {
      font-weight: 500;
    }
    
    .user-role {
      font-size: 12px;
      color: var(--text-light);
    }
    
    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }
    
    .logout-button {
      background-color: var(--danger);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      margin-left: 15px;
    }
    
    .logout-button:hover {
      background-color: #dc2626;
    }
    
    /* Professionals Grid */
    .professionals-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .professional-card {
      background-color: var(--bg-white);
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      padding: 20px;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
    }
    
    .professional-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-3px);
    }
    
    .professional-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .professional-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background-color: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: 600;
      margin-right: 15px;
      flex-shrink: 0;
    }
    
    .professional-photo {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 15px;
      flex-shrink: 0;
    }
    
    .professional-info {
      flex-grow: 1;
    }
    
    .professional-name {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .professional-type {
      color: var(--text-light);
      font-size: 14px;
      margin-bottom: 5px;
    }
    
    .professional-license {
      color: var(--text-light);
      font-size: 12px;
    }
    
    .professional-contact {
      display: flex;
      align-items: center;
      color: var(--text-light);
      font-size: 14px;
      margin-bottom: 5px;
    }
    
    .professional-icon {
      margin-right: 5px;
    }
    
    .professional-specialization {
      margin: 15px 0;
      padding: 15px 0;
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
    }
    
    .specialization-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 5px;
      color: var(--text-light);
    }
    
    .specialization-text {
      font-size: 14px;
    }
    
    .professional-footer {
      display: flex;
      justify-content: space-between;
      margin-top: auto;
    }
    
    .professional-actions {
      display: flex;
      gap: 10px;
    }
    
    /* Add Professional Card */
    .add-professional-card {
      background-color: rgba(75, 108, 183, 0.05);
      border: 2px dashed var(--primary);
      border-radius: 8px;
      padding: 20px;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .add-professional-card:hover {
      background-color: rgba(75, 108, 183, 0.1);
    }
    
    .add-professional-icon {
      font-size: 36px;
      color: var(--primary);
      margin-bottom: 15px;
    }
    
    .add-professional-text {
      font-size: 16px;
      font-weight: 500;
      color: var(--primary);
    }
    
    /* Table */
    .table-container {
      background-color: var(--bg-white);
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      overflow-x: auto;
      margin-bottom: 30px;
    }
    
    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 600;
      margin: 0;
    }
    
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .filter-group {
      display: flex;
      flex-direction: column;
      min-width: 180px;
    }
    
    .filter-label {
      font-size: 14px;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    .filter-control {
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 14px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th {
      text-align: left;
      padding: 12px 15px;
      border-bottom: 1px solid var(--border);
      font-weight: 500;
      color: var(--text-light);
    }
    
    td {
      padding: 12px 15px;
      border-bottom: 1px solid var(--border);
    }
    
    tr:last-child td {
      border-bottom: none;
    }
    
    .status {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .status-active {
      background-color: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }
    
    .status-inactive {
      background-color: rgba(239, 68, 68, 0.1);
      color: var(--danger);
    }
    
    .action-button {
      background: none;
      border: none;
      color: var(--primary);
      cursor: pointer;
      text-decoration: underline;
      padding: 0;
      font-size: 14px;
      margin-right: 10px;
    }
    
    .action-button.delete {
      color: var(--danger);
    }
    
    /* Button */
    .button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
    }
    
    .button-primary {
      background-color: var(--primary);
      color: white;
    }
    
    .button-primary:hover {
      background-color: var(--primary-dark);
    }
    
    .button-outline {
      background-color: transparent;
      border: 1px solid var(--primary);
      color: var(--primary);
    }
    
    .button-outline:hover {
      background-color: rgba(75, 108, 183, 0.1);
    }
    
    .button-danger {
      background-color: var(--danger);
      color: white;
    }
    
    .button-danger:hover {
      background-color: #dc2626;
    }
    
    /* Search input */
    .search-container {
      position: relative;
      width: 300px;
    }
    
    .search-input {
      width: 100%;
      padding: 8px 12px 8px 36px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 14px;
      transition: border-color 0.2s;
    }
    
    .search-input:focus {
      border-color: var(--primary);
      outline: none;
    }
    
    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-light);
    }
    
    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s, visibility 0.2s;
    }
    
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .modal {
      background-color: var(--bg-white);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      width: 100%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      transform: scale(0.9);
      transition: transform 0.2s;
    }
    
    .modal-overlay.active .modal {
      transform: scale(1);
    }
    
    .modal-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-title {
      font-size: 18px;
      font-weight: 600;
      margin: 0;
    }
    
    .close-button {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: var(--text-light);
    }
    
    .modal-body {
      padding: 20px;
    }
    
    .modal-footer {
      padding: 15px 20px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    
    /* Form */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group.span-2 {
      grid-column: span 2;
    }
    
    label {
      display: block;
      margin-bottom: 6px;
      font-size: 14px;
      font-weight: 500;
    }
    
    .form-control {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 14px;
      transition: border-color 0.2s;
    }
    
    .form-control:focus {
      border-color: var(--primary);
      outline: none;
    }
    
    select.form-control {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px;
    }
    
    textarea.form-control {
      min-height: 100px;
      resize: vertical;
    }
    
    .form-text {
      font-size: 12px;
      color: var(--text-light);
      margin-top: 4px;
    }
    
    .error-message {
      color: var(--danger);
      font-size: 12px;
      margin-top: 4px;
    }
    
    .checkbox-group {
      display: flex;
      align-items: center;
    }
    
    .checkbox-group input {
      margin-right: 8px;
    }
    
    /* Professional view modal */
    .professional-view-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .professional-view-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background-color: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      margin-right: 20px;
      flex-shrink: 0;
    }
    
    .professional-view-photo {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 20px;
      flex-shrink: 0;
    }
    
    .professional-view-info {
      flex: 1;
    }
    
    .professional-view-name {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .professional-view-type {
      font-size: 16px;
      color: var(--text-light);
      margin-bottom: 5px;
    }
    
    .professional-view-license {
      font-size: 14px;
      color: var(--text-light);
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      margin-bottom: 20px;
    }
    
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      font-weight: 500;
    }
    
    .tab.active {
      border-bottom: 2px solid var(--primary);
      color: var(--primary);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .detail-section {
      margin-bottom: 20px;
    }
    
    .detail-section-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
      padding-bottom: 5px;
      border-bottom: 1px solid var(--border);
    }
    
    .detail-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .detail-item {
      display: flex;
      flex-direction: column;
    }
    
    .detail-label {
      font-size: 14px;
      color: var(--text-light);
      margin-bottom: 5px;
    }
    
    .detail-value {
      font-size: 14px;
    }
    
    .bio-section {
      margin-bottom: 20px;
    }
    
    .bio-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .bio-text {
      font-size: 14px;
      line-height: 1.6;
    }
    
    /* Intern section */
    .interns-section {
      margin-top: 20px;
    }
    
    .interns-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
      padding-bottom: 5px;
      border-bottom: 1px solid var(--border);
    }
    
    .interns-list {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }
    
    .intern-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border: 1px solid var(--border);
      border-radius: 4px;
    }
    
    .intern-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin-right: 10px;
      flex-shrink: 0;
    }
    
    .intern-info {
      flex: 1;
    }
    
    .intern-name {
      font-weight: 500;
      margin-bottom: 3px;
    }
    
    .intern-email {
      font-size: 12px;
      color: var(--text-light);
    }
    
    /* Schedule section */
    .schedule-section {
      margin-top: 20px;
    }
    
    .schedule-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
      padding-bottom: 5px;
      border-bottom: 1px solid var(--border);
    }
    
    .schedule-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    
    .schedule-day {
      text-align: center;
      font-weight: 500;
      padding: 5px;
      border-bottom: 1px solid var(--border);
    }
    
    .schedule-hours {
      text-align: center;
      padding: 5px;
      font-size: 13px;
    }
    
    /* Empty state */
    .empty-state {
      padding: 40px;
      text-align: center;
    }
    
    .empty-icon {
      font-size: 48px;
      color: var(--text-light);
      margin-bottom: 16px;
    }
    
    .empty-text {
      font-size: 16px;
      color: var(--text-light);
      margin-bottom: 24px;
    }
    
    /* Badge */
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .badge-primary {
      background-color: rgba(75, 108, 183, 0.1);
      color: var(--primary);
    }
    
    .badge-secondary {
      background-color: rgba(24, 40, 72, 0.1);
      color: var(--secondary);
    }
    
    .badge-success {
      background-color: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }
    
    /* Pagination */
    .pagination {
      display: flex;
      list-style: none;
      justify-content: center;
      margin-top: 20px;
    }
    
    .pagination-item {
      margin: 0 5px;
    }
    
    .pagination-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 4px;
      border: 1px solid var(--border);
      color: var(--text-main);
      text-decoration: none;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    .pagination-link:hover {
      background-color: var(--bg-light);
    }
    
    .pagination-link.active {
      background-color: var(--primary);
      border-color: var(--primary);
      color: white;
    }
    
    .pagination-link.disabled {
      color: var(--text-light);
      pointer-events: none;
    }
    
    /* Image upload */
    .image-upload {
      position: relative;
      width: 100%;
      height: 160px;
      border: 2px dashed var(--border);
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      background-position: center;
      background-size: cover;
      background-repeat: no-repeat;
    }
    
    .image-upload:hover {
      border-color: var(--primary);
    }
    
    .image-upload-icon {
      font-size: 32px;
      color: var(--text-light);
      margin-bottom: 10px;
    }
    
    .image-upload-text {
      font-size: 14px;
      color: var(--text-light);
    }
    
    .image-upload.has-image .image-upload-icon,
    .image-upload.has-image .image-upload-text {
      display: none;
    }
    
    .image-upload.has-image::before {
      content: "";
      position: absolute;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: opacity 0.2s;
      border-radius: 6px;
    }
    
    .image-upload.has-image::after {
      content: "Alterar Imagem";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-weight: 500;
      opacity: 0;
      transition: opacity 0.2s;
    }
    
    .image-upload.has-image:hover::before,
    .image-upload.has-image:hover::after {
      opacity: 1;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .layout {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .user-menu {
        margin-top: 15px;
        width: 100%;
        justify-content: space-between;
      }
      
      .table-header {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .search-container {
        width: 100%;
        margin-top: 15px;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .form-group.span-2 {
        grid-column: span 1;
      }
      
      .detail-grid {
        grid-template-columns: 1fr;
      }
      
      .interns-list {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="logo">Cl√≠nica Equidade</div>
      <nav>
        <ul class="nav-list">
          <li class="nav-item">
            <a href="/dashboard.html" class="nav-link">
              <span class="nav-icon">üìä</span>
              Dashboard
            </a>
          </li>
          <li class="nav-item">
            <a href="/patients.html" class="nav-link">
              <span class="nav-icon">üë•</span>
              Pacientes
            </a>
          </li>
          <li class="nav-item">
            <a href="/professionals.html" class="nav-link active">
              <span class="nav-icon">üë®‚Äç‚öïÔ∏è</span>
              Profissionais
            </a>
          </li>
          <li class="nav-item">
            <a href="/appointments.html" class="nav-link">
              <span class="nav-icon">üìÖ</span>
              Agendamentos
            </a>
          </li>
          <li class="nav-item">
            <a href="/evolutions.html" class="nav-link">
              <span class="nav-icon">üìù</span>
              Evolu√ß√µes
            </a>
          </li>
          <li class="nav-item">
            <a href="/facilities.html" class="nav-link">
              <span class="nav-icon">üè•</span>
              Unidades
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <span class="nav-icon">üìä</span>
              Relat√≥rios
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <span class="nav-icon">‚öôÔ∏è</span>
              Configura√ß√µes
            </a>
          </li>
        </ul>
      </nav>
    </aside>
    
    <main class="main-content">
      <header class="header">
        <h1 class="page-title">Profissionais</h1>
        <div class="user-menu">
          <div class="user-info">
            <div class="user-name" id="userName">Carregando...</div>
            <div class="user-role" id="userRole"></div>
          </div>
          <div class="avatar" id="userAvatar">U</div>
          <button class="logout-button" id="logoutButton">Sair</button>
        </div>
      </header>
      
      <div class="filters">
        <div class="filter-group">
          <label class="filter-label">Especialidade</label>
          <select class="filter-control" id="typeFilter">
            <option value="">Todas as especialidades</option>
            <option value="psychologist">Psicologia</option>
            <option value="physiotherapist">Fisioterapia</option>
            <option value="speech_therapist">Fonoaudiologia</option>
            <option value="occupational_therapist">Terapia Ocupacional</option>
            <option value="other">Outra</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">Unidade</label>
          <select class="filter-control" id="facilityFilter">
            <option value="">Todas as unidades</option>
            <!-- Will be populated by JavaScript -->
          </select>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">Fun√ß√£o</label>
          <select class="filter-control" id="roleFilter">
            <option value="">Todas as fun√ß√µes</option>
            <option value="admin">Administrador</option>
            <option value="coordinator">Coordenador</option>
            <option value="professional">Profissional</option>
            <option value="intern">Estagi√°rio</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">Status</label>
          <select class="filter-control" id="statusFilter">
            <option value="">Todos os status</option>
            <option value="active">Ativo</option>
            <option value="inactive">Inativo</option>
          </select>
        </div>
        
        <div class="filter-group" style="align-self: flex-end;">
          <button class="button button-primary" id="filterButton">Filtrar</button>
        </div>
      </div>
      
      <div class="professionals-grid" id="professionalGrid">
        <!-- Professional cards will be added here by JavaScript -->
        
        <!-- Add Professional Card - only visible to admins -->
        <div class="add-professional-card" id="addProfessionalCard">
          <div class="add-professional-icon">+</div>
          <div class="add-professional-text">Adicionar Novo Profissional</div>
        </div>
      </div>
      
      <div class="table-container">
        <div class="table-header">
          <h2 class="card-title">Todos os Profissionais</h2>
          <div class="search-container">
            <span class="search-icon">üîç</span>
            <input type="text" class="search-input" id="searchProfessional" placeholder="Pesquisar por nome...">
          </div>
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Nome</th>
              <th>Especialidade</th>
              <th>Registro</th>
              <th>Contato</th>
              <th>Unidade</th>
              <th>Status</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="professionalsTableBody">
            <tr>
              <td colspan="7" class="text-center">Carregando profissionais...</td>
            </tr>
          </tbody>
        </table>
        
        <div class="pagination" id="pagination">
          <!-- Pagination will be generated by JavaScript -->
        </div>
      </div>
    </main>
  </div>
  
  <!-- Modal Add/Edit Professional -->
  <div class="modal-overlay" id="professionalModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">Adicionar Profissional</h3>
        <button class="close-button" id="closeModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="professionalForm">
          <input type="hidden" id="professionalId">
          <input type="hidden" id="userId">
          
          <div class="form-group">
            <label>Foto do Profissional</label>
            <div class="image-upload" id="profileImageUpload">
              <div class="image-upload-icon">üì∑</div>
              <div class="image-upload-text">Clique para adicionar foto</div>
              <input type="file" id="profileImage" style="display: none;" accept="image/*">
              <input type="hidden" id="profileImageUrl">
            </div>
          </div>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="fullName">Nome Completo *</label>
              <input type="text" id="fullName" class="form-control" required>
            </div>
            
            <div class="form-group">
              <label for="username">Nome de Usu√°rio *</label>
              <input type="text" id="username" class="form-control" required>
              <div class="form-text">Ser√° usado para login no sistema</div>
            </div>
            
            <div class="form-group" id="passwordGroup">
              <label for="password">Senha *</label>
              <input type="password" id="password" class="form-control" required>
            </div>
            
            <div class="form-group">
              <label for="email">E-mail *</label>
              <input type="email" id="email" class="form-control" required>
            </div>
            
            <div class="form-group">
              <label for="phone">Telefone *</label>
              <input type="tel" id="phone" class="form-control" required>
            </div>
            
            <div class="form-group">
              <label for="role">Fun√ß√£o *</label>
              <select id="role" class="form-control" required>
                <option value="">Selecione</option>
                <option value="admin">Administrador</option>
                <option value="coordinator">Coordenador</option>
                <option value="professional">Profissional</option>
                <option value="intern">Estagi√°rio</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="facilityId">Unidade *</label>
              <select id="facilityId" class="form-control" required>
                <option value="">Selecione</option>
                <!-- Will be populated by JavaScript -->
              </select>
            </div>
            
            <div class="form-group">
              <label for="professionalType">Especialidade *</label>
              <select id="professionalType" class="form-control" required>
                <option value="">Selecione</option>
                <option value="psychologist">Psicologia</option>
                <option value="physiotherapist">Fisioterapia</option>
                <option value="speech_therapist">Fonoaudiologia</option>
                <option value="occupational_therapist">Terapia Ocupacional</option>
                <option value="other">Outra</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="licenseNumber">N√∫mero do Registro</label>
              <input type="text" id="licenseNumber" class="form-control">
              <div class="form-text">CRP, CREFITO, etc.</div>
            </div>
            
            <div class="form-group">
              <label for="licenseType">Tipo de Registro</label>
              <input type="text" id="licenseType" class="form-control">
              <div class="form-text">Ex: CRP, CREFITO</div>
            </div>
            
            <div class="form-group span-2">
              <label for="specialization">Especializa√ß√£o/Forma√ß√£o</label>
              <input type="text" id="specialization" class="form-control">
              <div class="form-text">Ex: Mestrado em Psicologia Cl√≠nica, Especializa√ß√£o em ABA, etc.</div>
            </div>
            
            <div class="form-group">
              <label for="employmentType">Tipo de Contrata√ß√£o</label>
              <select id="employmentType" class="form-control">
                <option value="">Selecione</option>
                <option value="employee">CLT</option>
                <option value="contractor">Terceirizado/PJ</option>
                <option value="freelancer">Aut√¥nomo</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="hourlyRate">Valor Hora (R$)</label>
              <input type="number" id="hourlyRate" class="form-control" min="0" step="0.01">
            </div>
            
            <div class="form-group">
              <label for="supervisorId">Supervisor</label>
              <select id="supervisorId" class="form-control">
                <option value="">Selecione (se aplic√°vel)</option>
                <!-- Will be populated by JavaScript -->
              </select>
              <div class="form-text">Apenas para estagi√°rios ou profissionais em supervis√£o</div>
            </div>
            
            <div class="form-group span-2">
              <label for="bio">Biografia/Informa√ß√µes Profissionais</label>
              <textarea id="bio" class="form-control" rows="4"></textarea>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="isActive" checked>
                <label for="isActive">Usu√°rio ativo</label>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="button button-outline" id="cancelButton">Cancelar</button>
        <button class="button button-primary" id="saveButton">Salvar</button>
      </div>
    </div>
  </div>
  
  <!-- Modal View Professional Details -->
  <div class="modal-overlay" id="viewProfessionalModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Detalhes do Profissional</h3>
        <button class="close-button" id="closeViewModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="professional-view-header">
          <div class="professional-view-avatar" id="viewProfessionalAvatar">JS</div>
          <div class="professional-view-info">
            <div class="professional-view-name" id="viewProfessionalName">Carregando...</div>
            <div class="professional-view-type" id="viewProfessionalType"></div>
            <div class="professional-view-license" id="viewProfessionalLicense"></div>
          </div>
        </div>
        
        <div class="tabs">
          <div class="tab active" id="infoTab">Informa√ß√µes</div>
          <div class="tab" id="internsTab">Estagi√°rios</div>
          <div class="tab" id="scheduleTab">Agenda</div>
        </div>
        
        <div id="infoTabContent" class="tab-content active">
          <div class="detail-section">
            <h4 class="detail-section-title">Informa√ß√µes de Contato</h4>
            <div class="detail-grid">
              <div class="detail-item">
                <div class="detail-label">E-mail</div>
                <div class="detail-value" id="viewEmail"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Telefone</div>
                <div class="detail-value" id="viewPhone"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Unidade</div>
                <div class="detail-value" id="viewFacility"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Status</div>
                <div class="detail-value" id="viewStatus"></div>
              </div>
            </div>
          </div>
          
          <div class="detail-section">
            <h4 class="detail-section-title">Informa√ß√µes Profissionais</h4>
            <div class="detail-grid">
              <div class="detail-item">
                <div class="detail-label">Fun√ß√£o</div>
                <div class="detail-value" id="viewRole"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Especialidade</div>
                <div class="detail-value" id="viewProfessionalTypeDetail"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Tipo de Contrata√ß√£o</div>
                <div class="detail-value" id="viewEmploymentType"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Valor Hora</div>
                <div class="detail-value" id="viewHourlyRate"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Especializa√ß√£o</div>
                <div class="detail-value" id="viewSpecialization"></div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Supervisor</div>
                <div class="detail-value" id="viewSupervisor"></div>
              </div>
            </div>
          </div>
          
          <div class="bio-section">
            <h4 class="bio-title">Biografia</h4>
            <div class="bio-text" id="viewBio">Carregando biografia...</div>
          </div>
        </div>
        
        <div id="internsTabContent" class="tab-content">
          <div class="interns-section" id="internsSection">
            <h4 class="interns-title">Estagi√°rios Supervisionados</h4>
            <div class="interns-list" id="internsList">
              <!-- Interns will be added here by JavaScript -->
            </div>
          </div>
          
          <div class="empty-state" id="noInternsMessage" style="display: none;">
            <div class="empty-icon">üë§</div>
            <div class="empty-text">Este profissional n√£o supervisiona estagi√°rios atualmente</div>
          </div>
        </div>
        
        <div id="scheduleTabContent" class="tab-content">
          <div class="schedule-section">
            <h4 class="schedule-title">Cronograma Semanal</h4>
            <div class="schedule-grid">
              <div class="schedule-day">Segunda</div>
              <div class="schedule-day">Ter√ßa</div>
              <div class="schedule-day">Quarta</div>
              <div class="schedule-day">Quinta</div>
              <div class="schedule-day">Sexta</div>
              <div class="schedule-day">S√°bado</div>
              <div class="schedule-day">Domingo</div>
              
              <div class="schedule-hours" id="mondayHours">08:00 - 17:00</div>
              <div class="schedule-hours" id="tuesdayHours">08:00 - 17:00</div>
              <div class="schedule-hours" id="wednesdayHours">08:00 - 17:00</div>
              <div class="schedule-hours" id="thursdayHours">08:00 - 17:00</div>
              <div class="schedule-hours" id="fridayHours">08:00 - 17:00</div>
              <div class="schedule-hours" id="saturdayHours">-</div>
              <div class="schedule-hours" id="sundayHours">-</div>
            </div>
          </div>
          
          <div class="detail-section">
            <h4 class="detail-section-title">Estat√≠sticas</h4>
            <div class="detail-grid">
              <div class="detail-item">
                <div class="detail-label">Agendamentos (m√™s atual)</div>
                <div class="detail-value" id="viewAppointmentsCount">0</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Horas totais (m√™s atual)</div>
                <div class="detail-value" id="viewTotalHours">0h</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Pacientes atendidos</div>
                <div class="detail-value" id="viewPatientCount">0</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Evolu√ß√µes registradas</div>
                <div class="detail-value" id="viewEvolutionsCount">0</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="button button-outline" id="editProfessionalButton">Editar</button>
        <button class="button button-primary" id="closeDetailButton">Fechar</button>
      </div>
    </div>
  </div>
  
  <script>
    // Verificar autentica√ß√£o e carregar dados do usu√°rio
    document.addEventListener('DOMContentLoaded', async () => {
      await checkAuth();
      setupEventListeners();
      await Promise.all([
        loadFacilities(),
        loadProfessionals()
      ]);
    });
    
    // Elementos DOM
    const userNameElement = document.getElementById('userName');
    const userRoleElement = document.getElementById('userRole');
    const userAvatarElement = document.getElementById('userAvatar');
    const logoutButton = document.getElementById('logoutButton');
    const professionalGrid = document.getElementById('professionalGrid');
    const professionalsTableBody = document.getElementById('professionalsTableBody');
    const searchProfessional = document.getElementById('searchProfessional');
    const addProfessionalCard = document.getElementById('addProfessionalCard');
    const paginationElement = document.getElementById('pagination');
    
    // Modal Professional
    const professionalModal = document.getElementById('professionalModal');
    const modalTitle = document.getElementById('modalTitle');
    const professionalForm = document.getElementById('professionalForm');
    const professionalIdInput = document.getElementById('professionalId');
    const userIdInput = document.getElementById('userId');
    const closeModal = document.getElementById('closeModal');
    const cancelButton = document.getElementById('cancelButton');
    const saveButton = document.getElementById('saveButton');
    const passwordGroup = document.getElementById('passwordGroup');
    
    // Elementos para a imagem de perfil
    const profileImageUpload = document.getElementById('profileImageUpload');
    const profileImageInput = document.getElementById('profileImage');
    const profileImageUrlInput = document.getElementById('profileImageUrl');
    
    // Modal View Professional
    const viewProfessionalModal = document.getElementById('viewProfessionalModal');
    const closeViewModal = document.getElementById('closeViewModal');
    const closeDetailButton = document.getElementById('closeDetailButton');
    const editProfessionalButton = document.getElementById('editProfessionalButton');
    
    // Tabs
    const infoTab = document.getElementById('infoTab');
    const internsTab = document.getElementById('internsTab');
    const scheduleTab = document.getElementById('scheduleTab');
    const infoTabContent = document.getElementById('infoTabContent');
    const internsTabContent = document.getElementById('internsTabContent');
    const scheduleTabContent = document.getElementById('scheduleTabContent');
    
    // Filtros
    const typeFilter = document.getElementById('typeFilter');
    const facilityFilter = document.getElementById('facilityFilter');
    const roleFilter = document.getElementById('roleFilter');
    const statusFilter = document.getElementById('statusFilter');
    const filterButton = document.getElementById('filterButton');
    
    // Vari√°veis globais
    let currentUser = null;
    let professionals = [];
    let facilities = [];
    let currentProfessional = null;
    let currentPage = 1;
    const itemsPerPage = 10;
    
    // Verificar autentica√ß√£o
    async function checkAuth() {
      try {
        const response = await fetch('/api/user', {
          credentials: 'include'
        });
        
        if (!response.ok) {
          // N√£o autenticado, redirecionar para login
          window.location.href = '/login.html';
          return;
        }
        
        currentUser = await response.json();
        displayUserData(currentUser);
        
        // Configurar permiss√µes baseadas no papel do usu√°rio
        if (!['admin', 'coordinator'].includes(currentUser.role)) {
          addProfessionalCard.style.display = 'none';
        }
      } catch (error) {
        console.error('Erro ao verificar autentica√ß√£o:', error);
        window.location.href = '/login.html';
      }
    }
    
    // Exibir dados do usu√°rio
    function displayUserData(user) {
      userNameElement.textContent = user.fullName;
      userRoleElement.textContent = translateRole(user.role);
      
      // Iniciais do usu√°rio para o avatar
      const initials = user.fullName
        .split(' ')
        .map(name => name.charAt(0))
        .join('')
        .substring(0, 2)
        .toUpperCase();
      userAvatarElement.textContent = initials;
    }
    
    // Traduzir fun√ß√£o do ingl√™s para portugu√™s
    function translateRole(role) {
      const translations = {
        'admin': 'Administrador',
        'coordinator': 'Coordenador',
        'professional': 'Profissional',
        'intern': 'Estagi√°rio',
        'secretary': 'Secret√°rio(a)'
      };
      
      return translations[role] || role;
    }
    
    // Traduzir tipo de profissional
    function translateProfessionalType(type) {
      const translations = {
        'psychologist': 'Psicologia',
        'physiotherapist': 'Fisioterapia',
        'speech_therapist': 'Fonoaudiologia',
        'occupational_therapist': 'Terapia Ocupacional',
        'other': 'Outro'
      };
      
      return translations[type] || type;
    }
    
    // Traduzir tipo de contrata√ß√£o
    function translateEmploymentType(type) {
      const translations = {
        'employee': 'CLT',
        'contractor': 'Terceirizado/PJ',
        'freelancer': 'Aut√¥nomo'
      };
      
      return translations[type] || type;
    }
    
    // Configurar event listeners
    function setupEventListeners() {
      // Logout
      logoutButton.addEventListener('click', logout);
      
      // Pesquisar
      searchProfessional.addEventListener('input', filterProfessionals);
      
      // Adicionar profissional
      addProfessionalCard.addEventListener('click', openAddProfessionalModal);
      
      // Formul√°rio de profissional
      closeModal.addEventListener('click', closeProfessionalModal);
      cancelButton.addEventListener('click', closeProfessionalModal);
      saveButton.addEventListener('click', saveProfessional);
      
      // Upload de imagem
      profileImageUpload.addEventListener('click', () => profileImageInput.click());
      profileImageInput.addEventListener('change', handleProfileImageUpload);
      
      // Modal de visualiza√ß√£o
      closeViewModal.addEventListener('click', closeViewProfessionalModal);
      closeDetailButton.addEventListener('click', closeViewProfessionalModal);
      editProfessionalButton.addEventListener('click', editProfessionalFromView);
      
      // Tabs
      infoTab.addEventListener('click', () => switchTab('info'));
      internsTab.addEventListener('click', () => switchTab('interns'));
      scheduleTab.addEventListener('click', () => switchTab('schedule'));
      
      // Filtros
      filterButton.addEventListener('click', applyFilters);
      
      // Fechar modais ao clicar fora
      professionalModal.addEventListener('click', e => {
        if (e.target === professionalModal) closeProfessionalModal();
      });
      
      viewProfessionalModal.addEventListener('click', e => {
        if (e.target === viewProfessionalModal) closeViewProfessionalModal();
      });
    }
    
    // Carregar unidades para filtros e formul√°rio
    async function loadFacilities() {
      try {
        const response = await fetch('/api/facilities', {
          credentials: 'include'
        });
        
        if (!response.ok) {
          throw new Error('Erro ao carregar unidades');
        }
        
        facilities = await response.json();
        
        // Preencher select de unidade no formul√°rio
        const facilityIdSelect = document.getElementById('facilityId');
        facilityIdSelect.innerHTML = '<option value="">Selecione</option>';
        
        facilities.forEach(facility => {
          const option = document.createElement('option');
          option.value = facility.id;
          option.textContent = facility.name;
          facilityIdSelect.appendChild(option);
        });
        
        // Preencher select de unidade no filtro
        facilityFilter.innerHTML = '<option value="">Todas as unidades</option>';
        
        facilities.forEach(facility => {
          const option = document.createElement('option');
          option.value = facility.id;
          option.textContent = facility.name;
          facilityFilter.appendChild(option);
        });
      } catch (error) {
        console.error('Erro ao carregar unidades:', error);
      }
    }
    
    // Carregar profissionais
    async function loadProfessionals() {
      try {
        const response = await fetch('/api/professionals', {
          credentials: 'include'
        });
        
        if (!response.ok) {
          throw new Error('Erro ao carregar profissionais');
        }
        
        professionals = await response.json();
        renderProfessionalsGrid();
        renderProfessionalsTable();
        
        // Preencher supervisores no formul√°rio
        const supervisorIdSelect = document.getElementById('supervisorId');
        supervisorIdSelect.innerHTML = '<option value="">Selecione (se aplic√°vel)</option>';
        
        professionals
          .filter(p => ['admin', 'coordinator', 'professional'].includes(p.user.role))
          .forEach(professional => {
            const option = document.createElement('option');
            option.value = professional.id;
            option.textContent = professional.user.fullName;
            supervisorIdSelect.appendChild(option);
          });
      } catch (error) {
        console.error('Erro ao carregar profissionais:', error);
        professionalsTableBody.innerHTML = `
          <tr>
            <td colspan="7">Erro ao carregar profissionais. Tente novamente mais tarde.</td>
          </tr>
        `;
      }
    }
    
    // Renderizar grid de profissionais
    function renderProfessionalsGrid() {
      // Limpar grid, mantendo o card de adicionar
      const addCard = document.getElementById('addProfessionalCard');
      professionalGrid.innerHTML = '';
      professionalGrid.appendChild(addCard);
      
      // Se n√£o h√° profissionais
      if (professionals.length === 0) {
        const emptyCard = document.createElement('div');
        emptyCard.className = 'empty-state';
        emptyCard.innerHTML = `
          <div class="empty-icon">üë®‚Äç‚öïÔ∏è</div>
          <div class="empty-text">Nenhum profissional encontrado</div>
        `;
        professionalGrid.insertBefore(emptyCard, addCard);
        return;
      }
      
      // Mostrar no m√°ximo 4 profissionais no grid
      const displayProfessionals = professionals.slice(0, 4);
      
      // Adicionar cards de profissionais
      displayProfessionals.forEach(professional => {
        const card = document.createElement('div');
        card.className = 'professional-card';
        
        const initials = professional.user.fullName
          .split(' ')
          .map(name => name.charAt(0))
          .join('')
          .substring(0, 2)
          .toUpperCase();
        
        card.innerHTML = `
          <div class="professional-header">
            ${professional.user.profileImageUrl
              ? `<img src="${professional.user.profileImageUrl}" alt="${professional.user.fullName}" class="professional-photo">`
              : `<div class="professional-avatar">${initials}</div>`
            }
            <div class="professional-info">
              <h3 class="professional-name">${professional.user.fullName}</h3>
              <div class="professional-type">${translateProfessionalType(professional.professionalType)}</div>
              <div class="professional-license">${professional.licenseNumber ? `${professional.licenseType || ''} ${professional.licenseNumber}` : ''}</div>
            </div>
          </div>
          
          <div class="professional-contact">
            <span class="professional-icon">üìß</span> ${professional.user.email}
          </div>
          
          <div class="professional-contact">
            <span class="professional-icon">üìû</span> ${professional.user.phone || 'N√£o informado'}
          </div>
          
          <div class="professional-specialization">
            <div class="specialization-title">Especializa√ß√£o</div>
            <div class="specialization-text">${professional.specialization || 'N√£o informado'}</div>
          </div>
          
          <div class="professional-footer">
            <div>
              <span class="status ${professional.user.isActive ? 'status-active' : 'status-inactive'}">
                ${professional.user.isActive ? 'Ativo' : 'Inativo'}
              </span>
            </div>
            
            <div class="professional-actions">
              <button class="button button-outline view-professional" data-id="${professional.id}">Ver detalhes</button>
            </div>
          </div>
        `;
        
        professionalGrid.insertBefore(card, addCard);
      });
      
      // Adicionar event listeners
      document.querySelectorAll('.view-professional').forEach(button => {
        button.addEventListener('click', () => viewProfessional(parseInt(button.dataset.id)));
      });
    }
    
    // Renderizar tabela de profissionais
    function renderProfessionalsTable() {
      // Se n√£o h√° profissionais
      if (professionals.length === 0) {
        professionalsTableBody.innerHTML = `
          <tr>
            <td colspan="7" class="text-center">Nenhum profissional encontrado</td>
          </tr>
        `;
        paginationElement.innerHTML = '';
        return;
      }
      
      // Calcular pagina√ß√£o
      const totalPages = Math.ceil(professionals.length / itemsPerPage);
      const start = (currentPage - 1) * itemsPerPage;
      const end = Math.min(start + itemsPerPage, professionals.length);
      const paginatedProfessionals = professionals.slice(start, end);
      
      // Limpar tabela
      professionalsTableBody.innerHTML = '';
      
      // Adicionar linhas
      paginatedProfessionals.forEach(professional => {
        const row = document.createElement('tr');
        
        // Encontrar unidade
        const facility = facilities.find(f => f.id === professional.user.facilityId);
        
        row.innerHTML = `
          <td>${professional.user.fullName}</td>
          <td>${translateProfessionalType(professional.professionalType)}</td>
          <td>${professional.licenseNumber ? `${professional.licenseType || ''} ${professional.licenseNumber}` : '-'}</td>
          <td>${professional.user.email}<br>${professional.user.phone || ''}</td>
          <td>${facility ? facility.name : '-'}</td>
          <td><span class="status ${professional.user.isActive ? 'status-active' : 'status-inactive'}">${professional.user.isActive ? 'Ativo' : 'Inativo'}</span></td>
          <td>
            <button class="action-button view-professional" data-id="${professional.id}">Visualizar</button>
            <button class="action-button edit-professional" data-id="${professional.id}">Editar</button>
          </td>
        `;
        
        professionalsTableBody.appendChild(row);
      });
      
      // Adicionar pagina√ß√£o
      renderPagination(totalPages);
      
      // Adicionar event listeners
      document.querySelectorAll('.view-professional').forEach(button => {
        button.addEventListener('click', () => viewProfessional(parseInt(button.dataset.id)));
      });
      
      document.querySelectorAll('.edit-professional').forEach(button => {
        button.addEventListener('click', () => editProfessional(parseInt(button.dataset.id)));
      });
    }
    
    // Renderizar pagina√ß√£o
    function renderPagination(totalPages) {
      if (totalPages <= 1) {
        paginationElement.innerHTML = '';
        return;
      }
      
      let paginationHTML = '';
      
      // Bot√£o anterior
      paginationHTML += `
        <li class="pagination-item">
          <a href="#" class="pagination-link ${currentPage === 1 ? 'disabled' : ''}" data-page="${currentPage - 1}">
            &laquo;
          </a>
        </li>
      `;
      
      // P√°ginas
      for (let i = 1; i <= totalPages; i++) {
        paginationHTML += `
          <li class="pagination-item">
            <a href="#" class="pagination-link ${i === currentPage ? 'active' : ''}" data-page="${i}">
              ${i}
            </a>
          </li>
        `;
      }
      
      // Bot√£o pr√≥ximo
      paginationHTML += `
        <li class="pagination-item">
          <a href="#" class="pagination-link ${currentPage === totalPages ? 'disabled' : ''}" data-page="${currentPage + 1}">
            &raquo;
          </a>
        </li>
      `;
      
      paginationElement.innerHTML = paginationHTML;
      
      // Adicionar event listeners
      document.querySelectorAll('.pagination-link:not(.disabled)').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          currentPage = parseInt(link.dataset.page);
          renderProfessionalsTable();
        });
      });
    }
    
    // Filtrar profissionais
    function filterProfessionals() {
      const searchTerm = searchProfessional.value.toLowerCase();
      
      if (!searchTerm) {
        renderProfessionalsTable();
        return;
      }
      
      const filteredProfessionals = professionals.filter(professional =>
        professional.user.fullName.toLowerCase().includes(searchTerm) ||
        professional.user.email.toLowerCase().includes(searchTerm) ||
        (professional.licenseNumber && professional.licenseNumber.toLowerCase().includes(searchTerm))
      );
      
      // Atualizar temporariamente a lista
      const originalProfessionals = professionals;
      professionals = filteredProfessionals;
      currentPage = 1;
      
      renderProfessionalsTable();
      
      // Restaurar a lista original
      professionals = originalProfessionals;
    }
    
    // Aplicar filtros
    function applyFilters() {
      const professionalType = typeFilter.value;
      const facilityId = facilityFilter.value;
      const role = roleFilter.value;
      const isActive = statusFilter.value;
      
      // Fazer uma nova requisi√ß√£o com os filtros
      let url = '/api/professionals?';
      const params = [];
      
      if (professionalType) params.push(`professionalType=${professionalType}`);
      if (facilityId) params.push(`facilityId=${facilityId}`);
      if (role) params.push(`role=${role}`);
      if (isActive === 'active') params.push('isActive=true');
      if (isActive === 'inactive') params.push('isActive=false');
      
      url += params.join('&');
      
      fetch(url, { credentials: 'include' })
        .then(response => {
          if (!response.ok) throw new Error('Erro ao filtrar profissionais');
          return response.json();
        })
        .then(data => {
          professionals = data;
          currentPage = 1;
          renderProfessionalsGrid();
          renderProfessionalsTable();
        })
        .catch(error => {
          console.error('Erro ao aplicar filtros:', error);
          alert('Erro ao aplicar filtros. Tente novamente.');
        });
    }
    
    // Abrir modal para adicionar profissional
    function openAddProfessionalModal() {
      modalTitle.textContent = 'Adicionar Profissional';
      professionalForm.reset();
      professionalIdInput.value = '';
      userIdInput.value = '';
      passwordGroup.style.display = 'block';
      
      // Resetar imagem de perfil
      profileImageUpload.style.backgroundImage = '';
      profileImageUpload.classList.remove('has-image');
      profileImageUrlInput.value = '';
      
      document.getElementById('isActive').checked = true;
      
      professionalModal.classList.add('active');
    }
    
    // Abrir modal para editar profissional
    async function editProfessional(professionalId) {
      try {
        const response = await fetch(`/api/professionals/${professionalId}`, {
          credentials: 'include'
        });
        
        if (!response.ok) {
          throw new Error('Erro ao carregar detalhes do profissional');
        }
        
        const professional = await response.json();
        
        modalTitle.textContent = 'Editar Profissional';
        
        // Ocultar campo de senha para edi√ß√£o
        passwordGroup.style.display = 'none';
        
        // Preencher formul√°rio
        professionalIdInput.value = professional.id;
        userIdInput.value = professional.user.id;
        document.getElementById('fullName').value = professional.user.fullName;
        document.getElementById('username').value = professional.user.username;
        document.getElementById('email').value = professional.user.email;
        document.getElementById('phone').value = professional.user.phone || '';
        document.getElementById('role').value = professional.user.role;
        document.getElementById('facilityId').value = professional.user.facilityId;
        document.getElementById('professionalType').value = professional.professionalType;
        document.getElementById('licenseNumber').value = professional.licenseNumber || '';
        document.getElementById('licenseType').value = professional.licenseType || '';
        document.getElementById('specialization').value = professional.specialization || '';
        document.getElementById('employmentType').value = professional.employmentType || '';
        document.getElementById('hourlyRate').value = professional.hourlyRate || '';
        document.getElementById('supervisorId').value = professional.supervisorId || '';
        document.getElementById('bio').value = professional.bio || '';
        document.getElementById('isActive').checked = professional.user.isActive;
        
        // Definir imagem de perfil
        if (professional.user.profileImageUrl) {
          profileImageUpload.style.backgroundImage = `url("${professional.user.profileImageUrl}")`;
          profileImageUpload.classList.add('has-image');
          profileImageUrlInput.value = professional.user.profileImageUrl;
        } else {
          profileImageUpload.style.backgroundImage = '';
          profileImageUpload.classList.remove('has-image');
          profileImageUrlInput.value = '';
        }
        
        professionalModal.classList.add('active');
      } catch (error) {
        console.error('Erro ao editar profissional:', error);
        alert('Erro ao carregar detalhes do profissional. Tente novamente.');
      }
    }
    
    // Editar a partir da visualiza√ß√£o
    function editProfessionalFromView() {
      closeViewProfessionalModal();
      if (currentProfessional) {
        editProfessional(currentProfessional.id);
      }
    }
    
    // Fechar modal de profissional
    function closeProfessionalModal() {
      professionalModal.classList.remove('active');
    }
    
    // Fechar modal de visualiza√ß√£o
    function closeViewProfessionalModal() {
      viewProfessionalModal.classList.remove('active');
    }
    
    // Alternar entre as abas
    function switchTab(tab) {
      // Remover classe ativa de todas as abas
      infoTab.classList.remove('active');
      internsTab.classList.remove('active');
      scheduleTab.classList.remove('active');
      
      infoTabContent.classList.remove('active');
      internsTabContent.classList.remove('active');
      scheduleTabContent.classList.remove('active');
      
      // Adicionar classe ativa √† aba clicada
      if (tab === 'info') {
        infoTab.classList.add('active');
        infoTabContent.classList.add('active');
      } else if (tab === 'interns') {
        internsTab.classList.add('active');
        internsTabContent.classList.add('active');
      } else if (tab === 'schedule') {
        scheduleTab.classList.add('active');
        scheduleTabContent.classList.add('active');
      }
    }
    
    // Manipular upload de imagem
    function handleProfileImageUpload(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      // Tipos de arquivo permitidos
      const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];
      if (!allowedTypes.includes(file.type)) {
        alert('Tipo de arquivo n√£o suportado. Por favor, utilize JPG, PNG ou GIF.');
        return;
      }
      
      // Tamanho m√°ximo: 2MB
      const maxSize = 2 * 1024 * 1024;
      if (file.size > maxSize) {
        alert('Arquivo muito grande. O tamanho m√°ximo √© 2MB.');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        profileImageUpload.style.backgroundImage = `url("${e.target.result}")`;
        profileImageUpload.classList.add('has-image');
        
        // Aqui voc√™ poderia fazer upload para um servi√ßo de armazenamento
        // Por ora, vamos usar a URL de dados diretamente
        profileImageUrlInput.value = e.target.result;
      };
      reader.readAsDataURL(file);
    }
    
    // Salvar profissional
    async function saveProfessional() {
      try {
        // Valida√ß√£o b√°sica
        const fullNameInput = document.getElementById('fullName');
        const usernameInput = document.getElementById('username');
        const emailInput = document.getElementById('email');
        const phoneInput = document.getElementById('phone');
        const roleInput = document.getElementById('role');
        const facilityIdInput = document.getElementById('facilityId');
        const professionalTypeInput = document.getElementById('professionalType');
        const passwordInput = document.getElementById('password');
        
        if (!fullNameInput.value) {
          alert('Por favor, insira o nome completo');
          fullNameInput.focus();
          return;
        }
        
        if (!usernameInput.value) {
          alert('Por favor, insira o nome de usu√°rio');
          usernameInput.focus();
          return;
        }
        
        if (!professionalIdInput.value && !passwordInput.value) {
          alert('Por favor, insira uma senha');
          passwordInput.focus();
          return;
        }
        
        if (!emailInput.value) {
          alert('Por favor, insira o e-mail');
          emailInput.focus();
          return;
        }
        
        if (!phoneInput.value) {
          alert('Por favor, insira o telefone');
          phoneInput.focus();
          return;
        }
        
        if (!roleInput.value) {
          alert('Por favor, selecione a fun√ß√£o');
          roleInput.focus();
          return;
        }
        
        if (!facilityIdInput.value) {
          alert('Por favor, selecione a unidade');
          facilityIdInput.focus();
          return;
        }
        
        if (!professionalTypeInput.value) {
          alert('Por favor, selecione a especialidade');
          professionalTypeInput.focus();
          return;
        }
        
        // Preparar dados do profissional
        const professionalData = {
          username: usernameInput.value,
          fullName: fullNameInput.value,
          email: emailInput.value,
          phone: phoneInput.value,
          role: roleInput.value,
          facilityId: parseInt(facilityIdInput.value),
          profileImageUrl: profileImageUrlInput.value,
          isActive: document.getElementById('isActive').checked,
          professionalType: professionalTypeInput.value,
          licenseNumber: document.getElementById('licenseNumber').value,
          licenseType: document.getElementById('licenseType').value,
          specialization: document.getElementById('specialization').value,
          employmentType: document.getElementById('employmentType').value,
          hourlyRate: document.getElementById('hourlyRate').value 
            ? parseFloat(document.getElementById('hourlyRate').value) 
            : null,
          supervisorId: document.getElementById('supervisorId').value
            ? parseInt(document.getElementById('supervisorId').value)
            : null,
          bio: document.getElementById('bio').value
        };
        
        // Adicionar senha apenas para novos profissionais
        if (!professionalIdInput.value) {
          professionalData.password = passwordInput.value;
        }
        
        let response;
        
        if (professionalIdInput.value) {
          // Editar profissional existente
          response = await fetch(`/api/professionals/${professionalIdInput.value}`, {
            method: 'PUT',
            headers: {
              'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify(professionalData)
          });
        } else {
          // Adicionar novo profissional
          response = await fetch('/api/professionals', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify(professionalData)
          });
        }
        
        if (!response.ok) {
          const errorText = await response.text();
          throw new Error(errorText || 'Erro ao salvar profissional');
        }
        
        // Fechar modal e recarregar profissionais
        closeProfessionalModal();
        await loadProfessionals();
        
        alert(professionalIdInput.value ? 'Profissional atualizado com sucesso!' : 'Profissional adicionado com sucesso!');
      } catch (error) {
        console.error('Erro ao salvar profissional:', error);
        alert(`Erro ao salvar profissional: ${error.message}`);
      }
    }
    
    // Visualizar profissional
    async function viewProfessional(professionalId) {
      try {
        const response = await fetch(`/api/professionals/${professionalId}`, {
          credentials: 'include'
        });
        
        if (!response.ok) {
          throw new Error('Erro ao carregar detalhes do profissional');
        }
        
        currentProfessional = await response.json();
        
        // Encontrar unidade
        const facility = facilities.find(f => f.id === currentProfessional.user.facilityId);
        
        // Encontrar supervisor
        let supervisor = null;
        if (currentProfessional.supervisorId) {
          supervisor = professionals.find(p => p.id === currentProfessional.supervisorId);
        }
        
        // Iniciais do profissional para o avatar
        const initials = currentProfessional.user.fullName
          .split(' ')
          .map(name => name.charAt(0))
          .join('')
          .substring(0, 2)
          .toUpperCase();
        
        // Avatar
        if (currentProfessional.user.profileImageUrl) {
          document.getElementById('viewProfessionalAvatar').style.display = 'none';
          
          // Criar elemento de imagem ou atualizar existente
          let photoElement = document.querySelector('.professional-view-photo');
          if (!photoElement) {
            photoElement = document.createElement('img');
            photoElement.className = 'professional-view-photo';
            photoElement.alt = currentProfessional.user.fullName;
            document.querySelector('.professional-view-header').insertBefore(
              photoElement,
              document.querySelector('.professional-view-info')
            );
          }
          
          photoElement.src = currentProfessional.user.profileImageUrl;
        } else {
          // Remover foto se existir
          const photoElement = document.querySelector('.professional-view-photo');
          if (photoElement) photoElement.remove();
          
          document.getElementById('viewProfessionalAvatar').style.display = 'flex';
          document.getElementById('viewProfessionalAvatar').textContent = initials;
        }
        
        // Informa√ß√µes b√°sicas
        document.getElementById('viewProfessionalName').textContent = currentProfessional.user.fullName;
        document.getElementById('viewProfessionalType').textContent = translateProfessionalType(currentProfessional.professionalType);
        document.getElementById('viewProfessionalLicense').textContent = currentProfessional.licenseNumber
          ? `${currentProfessional.licenseType || ''} ${currentProfessional.licenseNumber}`
          : '';
        
        // Informa√ß√µes de contato
        document.getElementById('viewEmail').textContent = currentProfessional.user.email;
        document.getElementById('viewPhone').textContent = currentProfessional.user.phone || 'N√£o informado';
        document.getElementById('viewFacility').textContent = facility ? facility.name : 'N√£o definida';
        document.getElementById('viewStatus').innerHTML = `
          <span class="status ${currentProfessional.user.isActive ? 'status-active' : 'status-inactive'}">
            ${currentProfessional.user.isActive ? 'Ativo' : 'Inativo'}
          </span>
        `;
        
        // Informa√ß√µes profissionais
        document.getElementById('viewRole').textContent = translateRole(currentProfessional.user.role);
        document.getElementById('viewProfessionalTypeDetail').textContent = translateProfessionalType(currentProfessional.professionalType);
        document.getElementById('viewEmploymentType').textContent = currentProfessional.employmentType
          ? translateEmploymentType(currentProfessional.employmentType)
          : 'N√£o informado';
        document.getElementById('viewHourlyRate').textContent = currentProfessional.hourlyRate
          ? `R$ ${parseFloat(currentProfessional.hourlyRate).toFixed(2)}`
          : 'N√£o informado';
        document.getElementById('viewSpecialization').textContent = currentProfessional.specialization || 'N√£o informado';
        document.getElementById('viewSupervisor').textContent = supervisor
          ? supervisor.user.fullName
          : 'N√£o possui';
        
        // Biografia
        document.getElementById('viewBio').textContent = currentProfessional.bio || 'Nenhuma biografia adicionada.';
        
        // Estagi√°rios
        if (currentProfessional.interns && currentProfessional.interns.length > 0) {
          document.getElementById('internsList').innerHTML = '';
          document.getElementById('noInternsMessage').style.display = 'none';
          document.getElementById('internsSection').style.display = 'block';
          
          currentProfessional.interns.forEach(intern => {
            const internInitials = intern.user.fullName
              .split(' ')
              .map(name => name.charAt(0))
              .join('')
              .substring(0, 2)
              .toUpperCase();
            
            const internElement = document.createElement('div');
            internElement.className = 'intern-item';
            internElement.innerHTML = `
              <div class="intern-avatar">${internInitials}</div>
              <div class="intern-info">
                <div class="intern-name">${intern.user.fullName}</div>
                <div class="intern-email">${intern.user.email}</div>
              </div>
            `;
            
            document.getElementById('internsList').appendChild(internElement);
          });
        } else {
          document.getElementById('internsSection').style.display = 'none';
          document.getElementById('noInternsMessage').style.display = 'block';
        }
        
        // Estat√≠sticas
        loadProfessionalStats(currentProfessional.id);
        
        // Mostrar primeira aba
        switchTab('info');
        
        // Exibir modal
        viewProfessionalModal.classList.add('active');
      } catch (error) {
        console.error('Erro ao visualizar profissional:', error);
        alert('Erro ao carregar detalhes do profissional. Tente novamente.');
      }
    }
    
    // Carregar estat√≠sticas do profissional
    async function loadProfessionalStats(professionalId) {
      try {
        // Obter estat√≠sticas de agendamentos
        const appointmentsResponse = await fetch(`/api/professionals/${professionalId}/stats`, {
          credentials: 'include'
        });
        
        if (appointmentsResponse.ok) {
          const stats = await appointmentsResponse.json();
          
          // Estat√≠sticas por tipo (m√™s atual)
          document.getElementById('viewAppointmentsCount').textContent = stats.totalAppointments || 0;
          document.getElementById('viewTotalHours').textContent = stats.totalHours 
            ? `${stats.totalHours}h` 
            : '0h';
          
          // Total de pacientes atendidos
          document.getElementById('viewPatientCount').textContent = stats.patientCount || 0;
          
          // Evolu√ß√µes
          document.getElementById('viewEvolutionsCount').textContent = stats.evolutionCount || 0;
        }
      } catch (error) {
        console.error('Erro ao carregar estat√≠sticas do profissional:', error);
      }
    }
    
    // Logout
    async function logout() {
      try {
        await fetch('/api/logout', {
          method: 'POST',
          credentials: 'include'
        });
        
        window.location.href = '/login.html';
      } catch (error) {
        console.error('Erro ao fazer logout:', error);
        alert('Erro ao fazer logout. Tente novamente.');
      }
    }
  </script>
</body>
</html>